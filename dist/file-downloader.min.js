((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self)["file-downloader"]=t()})(this,function(){function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var r=e(t(function(e){function u(e,t,i,n,r,o,a){try{var s=e[o](a),u=s.value}catch(e){return i(e)}s.done?t(u):Promise.resolve(u).then(n,r)}e.exports=function(s){return function(){var e=this,a=arguments;return new Promise(function(t,i){var n=s.apply(e,a);function r(e){u(n,t,i,r,o,"next",e)}function o(e){u(n,t,i,r,o,"throw",e)}r(void 0)})}},e.exports.__esModule=!0,e.exports.default=e.exports})),n=t(function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n},e.exports.__esModule=!0,e.exports.default=e.exports}),i=(e(n),t(function(e){e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports})),o=(e(i),t(function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports})),a=(e(o),t(function(e){e.exports=function(e,t){var i;if(e)return"string"==typeof e?n(e,t):"Map"===(i="Object"===(i={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:i)||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0},e.exports.__esModule=!0,e.exports.default=e.exports})),s=(e(a),t(function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports})),u=(e(s),t(function(e){e.exports=function(e){return i(e)||o(e)||a(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports})),c=e(u),h=e(t(function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports})),l=t(function(t){function i(e){return t.exports=i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,i(e)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports}),p=(e(l),t(function(e){var n=l.default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);if(i=i.call(e,t||"default"),"object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")},e.exports.__esModule=!0,e.exports.default=e.exports})),f=(e(p),t(function(e){var t=l.default;e.exports=function(e){return e=p(e,"string"),"symbol"==t(e)?e:e+""},e.exports.__esModule=!0,e.exports.default=e.exports})),u=(e(f),t(function(e){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports})),d=e(u),u=t(function(F){var E=l.default;function e(){F.exports=function(){return a},F.exports.__esModule=!0,F.exports.default=F.exports;var u,a={},e=Object.prototype,c=e.hasOwnProperty,l=Object.defineProperty||function(e,t,i){e[t]=i.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",i=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function o(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(u){o=function(e,t,i){return e[t]=i}}function s(e,t,i,n){var r,o,a,s,t=t&&t.prototype instanceof g?t:g,t=Object.create(t.prototype),n=new I(n||[]);return l(t,"_invoke",{value:(r=e,o=i,a=n,s=f,function(e,t){if(s===h)throw Error("Generator is already running");if(s===m){if("throw"===e)throw t;return{value:u,done:!0}}for(a.method=e,a.arg=t;;){var i=a.delegate;if(i){i=function e(t,i){var n=i.method,r=t.iterator[n];if(r===u)return i.delegate=null,"throw"===n&&t.iterator.return&&(i.method="return",i.arg=u,e(t,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;n=p(r,t.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,v;r=n.arg;return r?r.done?(i[t.resultName]=r.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=u),i.delegate=null,v):r:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,v)}(i,a);if(i){if(i===v)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===f)throw s=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=h;i=p(r,o,a);if("normal"===i.type){if(s=a.done?m:d,i.arg===v)continue;return{value:i.arg,done:a.done}}"throw"===i.type&&(s=m,a.method="throw",a.arg=i.arg)}})}),t}function p(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f="suspendedStart",d="suspendedYield",h="executing",m="completed",v={};function g(){}function x(){}function y(){}var t={},b=(o(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(L([]))),w=(b&&b!==e&&c.call(b,n)&&(t=b),y.prototype=g.prototype=Object.create(t));function k(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function S(a,s){var t;l(this,"_invoke",{value:function(i,n){function e(){return new s(function(e,t){!function t(e,i,n,r){var o,e=p(a[e],a,i);if("throw"!==e.type)return(i=(o=e.arg).value)&&"object"==E(i)&&c.call(i,"__await")?s.resolve(i.__await).then(function(e){t("next",e,n,r)},function(e){t("throw",e,n,r)}):s.resolve(i).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,r)});r(e.arg)}(i,n,e,t)})}return t=t?t.then(e,e):e()}})}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function z(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function L(t){if(t||""===t){var i,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return i=-1,(e=function e(){for(;++i<t.length;)if(c.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=u,e.done=!0,e}).next=e}throw new TypeError(E(t)+" is not iterable")}return l(w,"constructor",{value:x.prototype=y,configurable:!0}),l(y,"constructor",{value:x,configurable:!0}),x.displayName=o(y,r,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,o(e,r,"GeneratorFunction")),e.prototype=Object.create(w),e},a.awrap=function(e){return{__await:e}},k(S.prototype),o(S.prototype,i,function(){return this}),a.AsyncIterator=S,a.async=function(e,t,i,n,r){void 0===r&&(r=Promise);var o=new S(s(e,t,i,n),r);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},k(w),o(w,r,"Generator"),o(w,n,function(){return this}),o(w,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t,i=Object(e),n=[];for(t in i)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in i)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=L,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(z),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=u)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var n=this;function e(e,t){return o.type="throw",o.arg=i,n.next=e,t&&(n.method="next",n.arg=u),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var a=c.call(r,"catchLoc"),s=c.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;0<=i;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var o=(r=r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc?null:r)?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),z(i),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var i,n,r=this.tryEntries[t];if(r.tryLoc===e)return"throw"===(i=r.completion).type&&(n=i.arg,z(r)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:L(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=u),v}},a}F.exports=e,F.exports.__esModule=!0,F.exports.default=F.exports}),u=(e(u),u()),g=u;try{regeneratorRuntime=u}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=u:Function("r","regeneratorRuntime = r")(u)}var m=t(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports}),u=(e(m),t(function(e){var i=l.default;e.exports=function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)},e.exports.__esModule=!0,e.exports.default=e.exports})),v=e(u),x=e(t(function(t){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.__esModule=!0,t.exports.default=t.exports,i(e)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports})),y=t(function(i){function n(e,t){return i.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i.exports.__esModule=!0,i.exports.default=i.exports,n(e,t)}i.exports=n,i.exports.__esModule=!0,i.exports.default=i.exports}),u=(e(y),t(function(e){e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports})),b=e(u),w=d(function e(){h(this,e)}),R={"3ds":"image/x-3ds","3g2":"video/3gpp2","3gp":"video/3gpp","7z":"application/x-7z-compressed",aac:"audio/x-aac",abw:"application/x-abiword",ace:"application/x-ace-compressed",adp:"audio/adpcm",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",apk:"application/vnd.android.package-archive",asf:"video/x-ms-asf",asx:"video/x-ms-asf",atom:"application/atom+xml",au:"audio/basic",avi:"video/x-msvideo",bat:"application/x-msdownload",bmp:"image/bmp",btif:"image/prs.btif",bz:"application/x-bzip",bz2:"application/x-bzip2",caf:"audio/x-caf",cgm:"image/cgm",cmx:"image/x-cmx",com:"application/x-msdownload",conf:"text/plain",css:"text/css",csv:"text/csv",dbk:"application/docbook+xml",deb:"application/x-debian-package",def:"text/plain",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dll:"application/x-msdownload",dmg:"application/x-apple-diskimage",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",dra:"audio/vnd.dra",dtd:"application/xml-dtd",dts:"audio/vnd.dts",dtshd:"audio/vnd.dts.hd",dvb:"video/vnd.dvb.file",dwg:"image/vnd.dwg",dxf:"image/vnd.dxf",ecelp4800:"audio/vnd.nuera.ecelp4800",ecelp7470:"audio/vnd.nuera.ecelp7470",ecelp9600:"audio/vnd.nuera.ecelp9600",emf:"application/x-msmetafile",emz:"application/x-msmetafile",eol:"audio/vnd.digital-winds",epub:"application/epub+zip",exe:"application/x-msdownload",f4v:"video/x-f4v",fbs:"image/vnd.fastbidsheet",fh:"image/x-freehand",fh4:"image/x-freehand",fh5:"image/x-freehand",fh7:"image/x-freehand",fhc:"image/x-freehand",flac:"audio/x-flac",fli:"video/x-fli",flv:"video/x-flv",fpx:"image/vnd.fpx",fst:"image/vnd.fst",fvt:"video/vnd.fvt",g3:"image/g3fax",gif:"image/gif",h261:"video/h261",h263:"video/h263",h264:"video/h264",heif:"image/heif",heic:"image/heic",htm:"text/html",html:"text/html",ico:"image/x-icon",ief:"image/ief",iso:"application/x-iso9660-image",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",jpgm:"video/jpm",jpgv:"video/jpeg",jpm:"video/jpm",json:"application/json",jsonml:"application/jsonml+json",kar:"audio/midi",ktx:"image/ktx",list:"text/plain",log:"text/plain",lvp:"audio/vnd.lucent.voice",m13:"application/x-msmediaview",m14:"application/x-msmediaview",m1v:"video/mpeg",m21:"application/mp21",m2a:"audio/mpeg",m2v:"video/mpeg",m3a:"audio/mpeg",m3u:"audio/x-mpegurl",m3u8:"application/vnd.apple.mpegurl",m4a:"audio/mp4",m4u:"video/vnd.mpegurl",m4v:"video/x-m4v",mdi:"image/vnd.ms-modi",mid:"audio/midi",midi:"audio/midi",mj2:"video/mj2",mjp2:"video/mj2",mk3d:"video/x-matroska",mka:"audio/x-matroska",mks:"video/x-matroska",mkv:"video/x-matroska",mmr:"image/vnd.fujixerox.edmics-mmr",mng:"video/x-mng",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"audio/mpeg",mp21:"application/mp21",mp2a:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mp4a:"audio/mp4",mp4s:"application/mp4",mp4v:"video/mp4",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpg4:"video/mp4",mpga:"audio/mpeg",mpkg:"application/vnd.apple.installer+xml",msi:"application/x-msdownload",mvb:"application/x-msmediaview",mxf:"application/mxf",mxml:"application/xv+xml",mxu:"video/vnd.mpegurl",npx:"image/vnd.net-fpx",odb:"application/vnd.oasis.opendocument.database",odc:"application/vnd.oasis.opendocument.chart",odf:"application/vnd.oasis.opendocument.formula",odft:"application/vnd.oasis.opendocument.formula-template",odg:"application/vnd.oasis.opendocument.graphics",odi:"application/vnd.oasis.opendocument.image",odm:"application/vnd.oasis.opendocument.text-master",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogg:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otc:"application/vnd.oasis.opendocument.chart-template",otg:"application/vnd.oasis.opendocument.graphics-template",oth:"application/vnd.oasis.opendocument.text-web",oti:"application/vnd.oasis.opendocument.image-template",otp:"application/vnd.oasis.opendocument.presentation-template",ots:"application/vnd.oasis.opendocument.spreadsheet-template",ott:"application/vnd.oasis.opendocument.text-template",oxt:"application/vnd.openofficeorg.extension",pbm:"image/x-portable-bitmap",pct:"image/x-pict",pcx:"image/x-pcx",pdf:"application/pdf",pgm:"image/x-portable-graymap",pic:"image/x-pict",plb:"application/vnd.3gpp.pic-bw-large",png:"image/png",pnm:"image/x-portable-anymap",pot:"application/vnd.ms-powerpoint",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",ppm:"image/x-portable-pixmap",pps:"application/vnd.ms-powerpoint",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",psb:"application/vnd.3gpp.pic-bw-small",psd:"image/vnd.adobe.photoshop",pvb:"application/vnd.3gpp.pic-bw-var",pya:"audio/vnd.ms-playready.media.pya",pyv:"video/vnd.ms-playready.media.pyv",qt:"video/quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"image/x-cmu-raster",rgb:"image/x-rgb",rip:"audio/vnd.rip",rlc:"image/vnd.fujixerox.edmics-rlc",rmi:"audio/midi",rmp:"audio/x-pn-realaudio-plugin",s3m:"audio/s3m",sgi:"image/sgi",sgm:"text/sgml",sgml:"text/sgml",sid:"image/x-mrsid-image",sil:"audio/silk",sldx:"application/vnd.openxmlformats-officedocument.presentationml.slide",smv:"video/x-smv",snd:"audio/basic",spx:"audio/ogg",srt:"application/x-subrip",sub:"text/vnd.dvb.subtitle",svg:"image/svg+xml",svgz:"image/svg+xml",swf:"application/x-shockwave-flash",tcap:"application/vnd.3gpp2.tcap",text:"text/plain",tga:"image/x-tga",tif:"image/tiff",tiff:"image/tiff",torrent:"application/x-bittorrent",tsv:"text/tab-separated-values",ttl:"text/turtle",txt:"text/plain",udeb:"application/x-debian-package",uva:"audio/vnd.dece.audio",uvg:"image/vnd.dece.graphic",uvh:"video/vnd.dece.hd",uvi:"image/vnd.dece.graphic",uvm:"video/vnd.dece.mobile",uvp:"video/vnd.dece.pd",uvs:"video/vnd.dece.sd",uvu:"video/vnd.uvvu.mp4",uvv:"video/vnd.dece.video",uvva:"audio/vnd.dece.audio",uvvg:"image/vnd.dece.graphic",uvvh:"video/vnd.dece.hd",uvvi:"image/vnd.dece.graphic",uvvm:"video/vnd.dece.mobile",uvvp:"video/vnd.dece.pd",uvvs:"video/vnd.dece.sd",uvvu:"video/vnd.uvvu.mp4",uvvv:"video/vnd.dece.video",viv:"video/vnd.vivo",vob:"video/x-ms-vob",wav:"audio/x-wav",wax:"audio/x-ms-wax",wbmp:"image/vnd.wap.wbmp",wdp:"image/vnd.ms-photo",weba:"audio/webm",webm:"video/webm",webp:"image/webp",wm:"video/x-ms-wm",wma:"audio/x-ms-wma",wmf:"application/x-msmetafile",wmv:"video/x-ms-wmv",wmx:"video/x-ms-wmx",wvx:"video/x-ms-wvx",xap:"application/x-silverlight-app",xbm:"image/x-xbitmap",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xhvml:"application/xv+xml",xif:"image/vnd.xiff",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xm:"audio/xm",xml:"application/xml",xop:"application/xop+xml",xpl:"application/xproc+xml",xpm:"image/x-xpixmap",xsl:"application/xml",xslt:"application/xslt+xml",xspf:"application/xspf+xml",xvm:"application/xv+xml",xvml:"application/xv+xml",xwd:"image/x-xwindowdump",zip:"application/zip"},k={};function S(e){e=_(e);return R[e]||"application/octet-stream"}function _(e,t,i){var t=1<arguments.length&&void 0!==t&&t,i=2<arguments.length&&void 0!==i&&i,n=(e=(e=String(e||""))||"unknown").substr(e.lastIndexOf(".")+1);return n===e?n="":i||9<(n=n.replace(/<[^>]*>/g,"").replace(/[^\w+]/g,"")).length&&(n=n.substr(0,9)),t?n.toUpperCase():n.toLowerCase()}var B=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function z(e,t,i){void 0===t&&(t=0),void 0===i&&(i=e.length);var n,r=e.length-i;t^=-1;for(var o=0;o<i;o++)n=255&(t^e[o+r]),t=t>>>8^B[n];return-1^t}for(var I=4294967296,L=[],F=0;F<256;F++)L[F]=(15<F?"":"0")+F.toString(16);var U="undefined"!=typeof Buffer,E=d(function c(e,t){var l=this;h(this,c),this.buffer=void 0,this.offset=void 0,this._2scomp=function(){for(var e=l.buffer,t=l.offset,i=1,n=t+7;t<=n;n--){var r=(255^e[n])+i;e[n]=255&r,i=r>>8}},this.setValue=function(e,t){var i=!1;if(!t)if("number"==typeof e){if(i=e<0,t=(e=Math.abs(e))%I,I<(e/=I))throw new RangeError(e+" is outside Int64 range");e|=0}else{if("string"!=typeof e)throw new Error(e+" must be a Number or String");t=(e=(e+"").replace(/^0x/,"")).substr(-8),e=8<e.length?e.substr(0,e.length-8):"",e=parseInt(e,16),t=parseInt(t,16)}for(var n=l.buffer,r=l.offset,o=7;0<=o;o--)n[r+o]=255&t,t=4==o?e:t>>>8;i&&l._2scomp()},this.toNumber=function(e){for(var t=l.buffer,i=l.offset,n=128&t[i],r=0,o=1,a=7,s=1;0<=a;a--,s*=256){var u=t[i+a];n&&(o=(u=(255^u)+o)>>8,u&=255),r+=u*s}return!e&&c.MAX_INT<=r?n?-1/0:1/0:n?-r:r},this.valueOf=function(){return l.toNumber(!1)},this.toString=function(e){return l.valueOf().toString(e||10)},this.toOctetString=function(e){for(var t=new Array(8),i=l.buffer,n=l.offset,r=0;r<8;r++)t[r]=L[i[n+r]];return t.join(e||"")},this.toBuffer=function(e){return e&&0===l.offset?l.buffer:(e=new Buffer(8),l.buffer.copy(e,0,l.offset,l.offset+8),e)},this.copy=function(e,t){l.buffer.copy(e,t||0,l.offset,l.offset+8)},this.compare=function(e){if((128&l.buffer[l.offset])!=(128&e.buffer[e.offset]))return e.buffer[e.offset]-l.buffer[l.offset];for(var t=0;t<8;t++)if(l.buffer[l.offset+t]!==e.buffer[e.offset+t])return l.buffer[l.offset+t]-e.buffer[e.offset+t];return 0},this.equals=function(e){return 0===l.compare(e)},this.inspect=function(){return"[Int64 value:"+l+" octets:"+l.toOctetString(" ")+"]"},(U?e instanceof Buffer:e instanceof Uint8Array)?(this.buffer=e,this.offset=t||0):"[object Uint8Array]"==Object.prototype.toString.call(e)?(this.buffer=new Buffer(e),this.offset=t||0):(this.buffer=this.buffer||new(U?Buffer:Uint8Array)(8),this.offset=0,this.setValue(e,t))});function O(e){return(new TextEncoder).encode(e)}function Z(){return N.apply(this,arguments)}function N(){return(N=r(g.mark(function e(t,i,n,r){var o,a,s,u,c,l,p,f,d,h,m,v;return g.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new Uint8Array(n),c=z(o,t.crc||0,o.byteLength),a=new D(i.fileSize),l=O(t.name),t.bufferAcc+=o.byteLength,t.crc=c,0===t.offset&&(t.headerPos=i.offset,(s=P(9+l.length)).i16(H),s.i16(5+l.length),s.i8(1),s.i32(z(l)),s.appendBytes(l),s=a.ZipHeader(l,t.fileSize,s.getArray()),(u=new Uint8Array(s.byteLength+o.byteLength)).set(s,0),u.set(o,s.byteLength),o=u),t.bufferAcc===t.fileSize?(s=a.ZipCentralDirectory(l,t.fileSize,t.fileSize,c,!1,t.headerPos),u=s.dataDescriptor,(l=new Uint8Array(o.byteLength+u.byteLength)).set(o,0),l.set(u,o.byteLength),o=l):t.offset+=o.byteLength,r){for(m in c=i.files.map(function(e){var t=O(e.name);return a.ZipCentralDirectory(t,e.fileSize,e.fileSize,e.crc,!1,e.headerPos).dirRecord}),l=a.ZipSuffix(o.byteLength+i.offset,c),p=i.files.map(function(e){return a.ZipCentralDirectory(O(e.name),e.fileSize,e.fileSize,e.crc,!1,e.headerPos).dirRecord}),f=0,d=o.byteLength,p)f+=p[m].byteLength;for(v in(h=new Uint8Array(o.byteLength+f+l.byteLength)).set(o,0),p)h.set(p[v],d),d+=p[v].byteLength;h.set(l,d),o=h}return i.offset+=o.byteLength,e.abrupt("return",new Promise(function(e,t){e(o)}));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}E.MAX_INT=Math.pow(2,53),E.MIN_INT=-Math.pow(2,53);var j=4294967295,H=28789,D=(()=>d(function e(t){h(this,e),this.maxZipSize=.9*Math.pow(2,31),this.isZip64=!1,this.zipVersion=20,this.isZip64=t>this.maxZipSize||1===localStorage.zip64,this.zipVersion=this.isZip64?45:20},[{key:"ZipHeader",value:function(e,t,i){var n=this.zipVersion,r=P(30+e.length+i.length);return r.i32(67324752),r.i16(n),r.i16(2056),r.i16(0),C(0,r),r.i32(0),r.i32(t),r.i32(0),r.i16(e.length),r.i16(i.length),r.appendBytes(e),r.appendBytes(i),r.getBytes()}},{key:"ZipCentralDirectory",value:function(e,t,i,n,r,o){var a=this.zipVersion,s=this.zipVersion,r=r?1:0,u=[],c=(this.isZip64&&((c=P(28)).i16(1),c.i16(24),c.i64(t),c.i64(i),c.i64(o),u=u.concat(c.getArray())),P(46+e.length+u.length)),a=(c.i32(33639248),c.i16(a),c.i16(s),c.i16(2056),c.i16(0),C(0,c),c.i32(n),c.i32(this.isZip64?j:t),c.i32(this.isZip64?j:i),c.i16(e.length),c.i16(u.length),c.i16(0),c.i32(0),c.i32(r),c.i32(this.isZip64?j:o),c.appendBytes(e),c.appendBytes(u),P(this.isZip64?24:16));return a.i32(134695760),a.i32(n),this.isZip64?(a.i64(t),a.i64(i)):(a.i32(t),a.i32(i)),{dirRecord:c.getBytes(),dataDescriptor:a.getBytes()}}},{key:"ZipSuffix",value:function(e,t){var i,n=0;for(i in t)n+=t[i].length;var r,o=P(22);return this.isZip64&&((r=P(76)).i32(101075792),r.i64(44),r.i16(this.zipVersion),r.i16(this.zipVersion),r.i32(0),r.i32(0),r.i64(t.length),r.i64(t.length),r.i64(n),r.i64(e),r.i32(117853008),r.i32(0),r.i64(e+n),r.i32(1),o.resize(22+r.getBytes().length),o.appendBytes(r.getBytes())),o.i32(101010256),o.i32(0),o.i16(this.isZip64?65535:t.length),o.i16(this.isZip64?65535:t.length),o.i32(this.isZip64?j:n),o.i32(this.isZip64?j:e),o.i16(0),o.getBytes()}}]))();function P(e){var r=new Uint8Array(e),i=new DataView(r.buffer),n=0;return{debug:function(){},getArray:function(){var n=[];return r.map(function(e,t,i){return n.push(e),e}),n},getBytes:function(){return r},appendBytes:function(e){for(var t="string"!=typeof e,i=e.length;i--;)r[n+i]=t?e[i]:e.charCodeAt(i);n+=e.length},i64:function(e,t){var i=new E(e,null).buffer;if(!t){for(var n=new Uint8Array(i.length),r=i.length-1,o=r;0<=o;o--)n[o]=i[r-o];i=n}this.appendBytes(i)},i32:function(e,t){i.setInt32(n,e,!t),n+=4},i16:function(e,t){i.setInt16(n,e,!t),n+=2},i8:function(e,t){i.setInt8(n,e),n+=1},resize:function(e){e=new Uint8Array(e);return e.set(r,0),r=e,i=new DataView(r.buffer),r},resizeIfNeeded:function(e){return r.length<e+n?this.resize(e+n):r}}}function C(e,t){var i,n=new Date,e=(n=e?new Date(1e3*e):n).getHours();e<<=6,e=(e=(e|n.getMinutes())<<5)|n.getSeconds()/2,i=n.getFullYear()-1980,i<<=4,i=(i=(i|n.getMonth()+1)<<5)|n.getDate(),t.i16(e),t.i16(i)}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(W=function(){return!!e})()}var M=window,q=(()=>{function r(){var n,e,t,i;return h(this,r),e=this,t=x(t=r),(n=v(e,W()?Reflect.construct(t,i||[],x(e).constructor):t.apply(e,i))).freeSpaceRequest=!1,n.entrtiesReaded=!1,n.allEntries=[],n.allResumeFiles=[],n.saveLink=function(e,t){var t="string"==typeof t&&t,i=document.createElement("a");i.download=e.name,i.href=t||e.fileEntry.toURL(),i.click()},n.saveFile=function(t,e){try{var i=new File([e],t.name,{type:S(t.name)});n.saveLink(t,window.URL.createObjectURL(i))}catch(e){n.saveLink(t)}},M.requestFileSystem=M.requestFileSystem||M.webkitRequestFileSystem,M.requestFileSystem(0,65536,function(e){e.root.getDirectory("savvy",{create:!0},function(e){e.createReader().readEntries(function(e){n.allEntries=e,n.entrtiesReaded=!0,n.freeSpaceRequest&&n.freeSpace(n.allResumeFiles)})})}),n}return b(r,w),d(r,[{key:"removeFile",value:function(i){return new Promise(function(t,e){M.requestFileSystem(0,65536,function(e){e.root.getDirectory("savvy",{create:!0},function(e){e.createReader().readEntries(function(e){e.forEach(function(e){e.name===i.name+i.id&&e.remove(function(){t()})})})})})})}},{key:"removeAll",value:function(){M.requestFileSystem(0,65536,function(e){e.root.getDirectory("savvy",{create:!0},function(e){e.createReader().readEntries(function(e){e.map(function(e){e.remove(function(){})})})})})}},{key:"getFileWriter",value:function(n,r,e){M.requestFileSystem(0,n.fileSize,function(t){t.root.getDirectory("savvy",{create:!0},function(e){t.root.getFile("savvy/"+n.name+n.id,{create:!0},function(i){i.getMetadata(function(t){i.createWriter(function(e){t.size&&0!==t.size&&(n.offset===t.size?e.seek(n.offset+1):n.offset<t.size?(e.onwriteend=function(){e.seek(n.offset+1),r({fileEntry:i,fileWriter:e})},e.truncate(n.offset)):(e.seek(0),n.abortAllResumeData())),r({fileEntry:i,fileWriter:e})})})})})})}},{key:"freeSpace",value:function(e){this.entrtiesReaded?(this.freeSpaceRequest=!1,this.allEntries.forEach(function(t){void 0===e.find(function(e){return e.name+e.id===t.name})&&t.remove(function(){},function(e){})})):(this.allResumeFiles=e,this.freeSpaceRequest=!0)}},{key:"write",value:function(e,r){return new Promise(function(t,i){if(e.fileWriter){var n=e.fileWriter;if(e.zip)Z(e.currentFile,e,r,e.chunkIndex===e.chunkList.length).then(function(e){try{n.onwriteend=function(e){t()},n.write(new Blob([e]))}catch(e){i()}});else try{n.onwriteend=function(e){t()},n.write(new Blob([r]))}catch(e){i()}}else i()})}},{key:"deleteFile",value:function(e){var t;e.fileEntry&&(t=e.fileEntry).isFile&&t.getMetadata(function(e){e=e.size/1024+3e4;setTimeout(function(){t.remove(function(){})},e)},function(e){})}},{key:"download",value:function(i){for(var n=this,e=0,t=i.length;e<t;e++)(t=>{var e=i[t].fileEntry;if("function"==typeof i[t].fileEntry.file)try{e.file(function(e){n.saveFile(i[t],e)},function(){n.saveLink(i[t])})}catch(e){}else n.saveLink(i[t])})(e)}}])})();function V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(V=function(){return!!e})()}var T="function"==typeof MSBlobBuilder,G=(()=>{function n(){return h(this,n),e=this,t=n,i=arguments,t=x(t),v(e,V()?Reflect.construct(t,i||[],x(e).constructor):t.apply(e,i));var e,t,i}return b(n,w),d(n,[{key:"getFileWriter",value:function(e,t,i){t({fileEntry:null,fileWriter:new J})}},{key:"write",value:function(e,r){return new Promise(function(t,i){var n=e.fileWriter;e.zip?Z(e.currentFile,e,r,e.chunkIndex===e.chunkList.length).then(function(e){try{n.onwriteend=function(e){t()},n.write(new Blob([e]))}catch(e){i()}}):(n.onwriteend=function(){t()},n.onerror=function(e){i()},n.write(new Blob([r])))})}},{key:"deleteFile",value:function(e){e.fileWriter.clear(),e.fileWriter=null}},{key:"download",value:function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t].fileWriter.getBlob(e[t].name),r="";T?navigator.msSaveOrOpenBlob(n,name):(r=window.URL.createObjectURL(n),(n=document.createElement("a")).download=e[t].name,n.href=r,document.body.appendChild(n),n.click())}}}])})(),J=(()=>d(function e(){h(this,e),this.blobList=void 0,this.onwriteend=void 0,this.onerror=void 0,this.position=0,this.blobList=T?new MSBlobBuilder:[],this.onwriteend=null,this.onerror=null},[{key:"getBlob",value:function(e){if(T)return this.blobList.getBlob();try{return new File(this.blobList,e,{type:S(e)})}catch(e){}return new Blob(this.blobList||[],{type:S(e)})}},{key:"write",value:function(e){try{T?this.blobList.append(e):this.blobList.push(e),this.onwriteend&&this.onwriteend()}catch(e){this.onerror&&this.onerror(e)}}},{key:"clear",value:function(){this.blobList=[]}}]))(),K=d(function e(t,i,n,r,o,a,s){h(this,e),this.chunkList=[],this.filePath=void 0,this.name=void 0,this.fileSize=void 0,this.offset=0,this.crc=0,this.headerPos=0,this.bufferAcc=0,this.filePath=t,this.name=i,this.fileSize=n,this.bufferAcc=o||0,this.offset=a||0,this.crc=s||0;for(var u=0,c=0;c<this.fileSize;)c=(c=u+r)>this.fileSize?this.fileSize:c,this.chunkList.push({filePath:this.filePath,start:u,end:c}),u=c+1}),A=(()=>d(function e(t,i,n,r,o,a,s,u,c,l){var p=this;if(h(this,e),this.files=void 0,this.name=void 0,this.fileType="File",this.IO=void 0,this._status="initializing",this.zip=void 0,this.id=void 0,this.offset=void 0,this.chunkIndex=void 0,this.chunkList=void 0,this.totalSize=void 0,this.fileSize=void 0,this.remainSize=void 0,this.fileWriter=null,this.fileEntry=void 0,this.progressHandle=void 0,this.statusUpdateHandle=void 0,this.processer=null,this.lock=!1,this.paused=!1,this.speed=0,this.startTime=0,this.init=function(){return new Promise(function(t,e){p.IO.getFileWriter(p,function(e){p.fileWriter=e.fileWriter,p.fileEntry=e.fileEntry,"abort"!==p.status&&(p.status="inited"),t()},e)})},this.update=function(e){"inited"===p.status&&(p.status="downloading");var t=(new Date).getTime()-p.startTime;p.speed=e/t*1e3,p.remainSize-=e,p.progressHandle&&p.progressHandle(p.id,p.speed,p.remainSize,p.status)},this.getStatus=function(){return p._status},this.files=t,this.name=i,this.fileType=(i=_(i=this.name),k[i]?k[i][1]:i&&1<i.length?"%1 File".replace("%1",i.toUpperCase()):"File"),this.IO=n,this.id=u||(new Date).getTime(),this.zip=a,this.totalSize=t.reduce(function(e,t){return e+t.fileSize},0),this.fileSize=0,a){for(var f=0,d=t.length;f<d;f++)this.fileSize+=t[f].fileSize+30+9+2*t[f].name.length+46+t[f].name.length;this.fileSize+=28*t.length,this.fileSize+=24*t.length,this.fileSize+=98}else this.fileSize=this.totalSize;this.chunkList=t.reduce(function(e,t){return e.concat(t.chunkList)},[]),this.offset=c||0,this.chunkIndex=s||0,this.chunkIndex===this.chunkList.length?this.remainSize=0:0!==this.chunkIndex?this.remainSize=this.totalSize-this.chunkList.reduce(function(e,t,i){return i<p.chunkIndex?e+=t.end-(0===t.start?0:t.start-1):e+=0,e},0):this.remainSize=this.totalSize,this.progressHandle=r,this.statusUpdateHandle=o},[{key:"abortAllResumeData",value:function(){this.chunkIndex=0,this.remainSize=this.totalSize,this.offset=0,this.files.forEach(function(e){e.offset=e.bufferAcc=0})}},{key:"nextChunk",value:function(){return this.startTime=(new Date).getTime(),this.chunkList[this.chunkIndex+1]||(this.status="chunk_empty"),this.chunkList[this.chunkIndex++]}},{key:"resumePreChunk",value:function(){"chunk_empty"===this.status&&(this.status="downloading"),--this.chunkIndex}},{key:"status",get:function(){return this._status},set:function(e){this._status=e,this.statusUpdateHandle&&this.statusUpdateHandle(this.id,e)}},{key:"currentFile",get:function(){for(var e=this.chunkIndex-1,t=0,i=this.files[0],n=0,r=this.files.length;n<r;n++)if(e<(t+=this.files[n].chunkList.length)){i=this.files[n];break}return i}}]))(),Y=(()=>{return d(function e(){var n=this;h(this,e),this.idle=!0,this.transfer=null,this.process=(()=>{var i=r(g.mark(function e(t,i){return g.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.paused)e.next=31;else{if("abort"===t.getStatus())return i.schedulingFiles.splice(i.schedulingFiles.findIndex(function(e){return e.id==e.id}),1),n.idle=!0,n.transfer=null,t.lock=!1,t.processer=null,i.distributeToProcessers(),e.abrupt("return");e.next=9}break;case 9:if(t.chunkIndex>=t.chunkList.length)return i.IO.download([t]),t.status="complete",i.storeFileForResume(t),i.IO.deleteFile(t),i.totalSize-=t.fileSize,i.schedulingFiles.splice(i.schedulingFiles.findIndex(function(e){return e.id==e.id}),1),n.idle=!0,n.transfer=null,t.lock=!1,t.processer=null,i.distributeToProcessers(),e.abrupt("return");e.next=22;break;case 22:if(t.fileWriter){e.next=27;break}return e.next=25,t.init();case 25:return n.run(t,i),e.abrupt("return");case 27:return n.fetchChunk(t,i).catch(function(e){t.resumePreChunk(),t.paused=!0,t.lock=!1,t.processer=null,n.idle=!0,"abort"!==t.status&&(t.status="error")}),e.abrupt("return");case 31:"abort"!==t.status&&(t.status="paused"),t.processer=null,t.lock=!1,n.idle=!0;case 35:case"end":return e.stop()}},e)}));return function(e,t){return i.apply(this,arguments)}})()},[{key:"run",value:function(e,t){(e.processer=this).transfer=e,this.idle=!1,e.lock||(e.lock=!0),e.paused?(e.lock=!1,this.idle=!(e.processer=null),"abort"!==e.status&&(e.status="paused")):(e.status="downloading",this.process(e,t))}},{key:"fetchChunk",value:(i=r(g.mark(function e(t,i){var n,r,o;return g.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.nextChunk(),e.next=3,fetch(n.filePath,{method:"GET",headers:{Range:"bytes=".concat(n.start,"-").concat(n.end)}});case 3:if(r=e.sent,t.paused)return this.pausedDuringFetch(t),e.abrupt("return");e.next=7;break;case 7:return e.next=9,r.arrayBuffer();case 9:if(o=e.sent,t.paused)return this.pausedDuringFetch(t),e.abrupt("return");e.next=13;break;case 13:return e.next=15,i.IO.write(t,o);case 15:if("abort"===t.getStatus())return i.schedulingFiles.splice(i.schedulingFiles.findIndex(function(e){return e.id==e.id}),1),this.idle=!0,this.transfer=null,t.lock=!1,t.processer=null,i.distributeToProcessers(),e.abrupt("return");e.next=23;break;case 23:return t.update(n.end-(0===n.start?0:n.start-1)),i.storeFileForResume(t),this.run(t,i),e.abrupt("return");case 27:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"pausedDuringFetch",value:function(e){e.resumePreChunk(),e.paused=!0,e.lock=!1,this.idle=!(e.processer=null),"abort"!==e.status&&(e.status="paused")}}]);var i})(),X=/\b(WOW64|x86_64|Win64|intel mac os x 10.(9|\d{2,}))/i.test(navigator.userAgent);return(()=>{return d(function e(t,i){var r=this;h(this,e),this.SIZE_LIMIT=1073741824*(1+(X?1:0)),this.CHUNK_SIZE=1048576,this.HTTP_NUM=5,this.totalSize=0,this.IO=void 0,this.IO_IS_FS=!1,this.progressHandle=void 0,this.statusUpdateHandle=void 0,this.running=!1,this.transfers=[],this.schedulingFiles=[],this.processers=[],this.schedule=function(e){for(var e=e||r.transfers.map(function(e){return e.id}),i=Array.from(new Set(e)),t=0,n=i.length;t<n;t++)(t=>{var e=r.transfers.find(function(e){return e.id===i[t]});e&&r.schedulingFiles.filter(function(e){return e.id===i[t]}).length<=0&&(e.status="queue",r.schedulingFiles.push(e))})(t);r.distributeToProcessers()},window.requestFileSystem||window.webkitRequestFileSystem?(this.IO=new q,this.IO_IS_FS=!0,this.SIZE_LIMIT=214748364800):this.IO=new G,this.progressHandle=t,this.statusUpdateHandle=i,this.processers=new Array(this.HTTP_NUM).fill("").map(function(e){return new Y})},[{key:"retrieveFilesFromLocalStorage",value:function(){var t=this,e=window.localStorage.getItem("savvy_transfers");if(e)try{var i,n=JSON.parse(e);(i=this.transfers).push.apply(i,c(n.map(function(e){return new A(e.files.map(function(e){return new K(e.path,e.name,e.size,t.CHUNK_SIZE,e.bufferAcc,e.offset,e.crc)}),e.name,t.IO,t.progressHandle,t.statusUpdateHandle,!0,e.chunkIndex,e.id,e.offset,!0)})))}catch(e){}return this.IO_IS_FS&&this.IO.freeSpace(this.transfers),this.transfers}},{key:"storeFileForResume",value:function(e){if("complete"===e.status)this.deleteFileFromStore(e);else{var t={id:e.id,name:e.name,type:e.zip?"zip":"normal",chunkIndex:e.chunkIndex,tag:e.chunkIndex===e.chunkList.length?1:0,offset:e.offset,files:e.files.map(function(e){return{name:e.name,path:e.filePath,size:e.fileSize,bufferAcc:e.bufferAcc,offset:e.offset,crc:e.crc}})},e=window.localStorage.getItem("savvy_transfers"),i=[];if(e)try{var n,r=(n=JSON.parse(e)).findIndex(function(e){return e.id===t.id});-1!==r?(n.splice(r,1,t),i.push.apply(i,c(n))):i.push.apply(i,c(n).concat([t]))}catch(e){}else i.push(t);window.localStorage.setItem("savvy_transfers",JSON.stringify(i))}}},{key:"deleteFileFromStore",value:function(t){var e=window.localStorage.getItem("savvy_transfers");if(e)try{var i,n=(i=JSON.parse(e)).findIndex(function(e){return e.id===t.id});-1!==n&&i.splice(n,1),window.localStorage.setItem("savvy_transfers",JSON.stringify(i))}catch(e){}}},{key:"addFiles",value:(t=r(g.mark(function e(t){var i,n,r,o,a,s,u=this,c=arguments;return g.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=1<c.length&&void 0!==c[1]&&c[1],n=2<c.length?c[2]:void 0,r=[],o=0,a=t.length;case 4:if(o<a)return e.prev=5,e.next=8,this.addFile(t[o].path,t[o].name);e.next=18;break;case 8:(s=e.sent)&&"string"!=typeof s&&r.push(s),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(5),e.t0;case 15:o++,e.next=4;break;case 18:if(i)return s=new A(r,n,this.IO,this.progressHandle,this.statusUpdateHandle,!0),this.transfers.push(s),this.storeFileForResume(s),e.abrupt("return",s);e.next=25;break;case 25:return e.abrupt("return",r.map(function(e){return new A([e],e.name,u.IO,u.progressHandle,u.statusUpdateHandle,!1)}));case 26:case"end":return e.stop()}},e,this,[[5,12]])})),function(e){return t.apply(this,arguments)})},{key:"addFile",value:(i=r(g.mark(function e(t,i){var n,r,o;return g.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}throw new Error("Invalid file path");case 3:return e.next=5,fetch(t,{method:"GET",headers:{Range:"bytes=0-1"}});case 5:if((n=e.sent).headers.get("content-range")){e.next=10;break}throw new Error("Can not get file size, check file path or contact service provider.");case 10:if((r=parseInt(n.headers.get("content-range").split("/")[1]))>this.SIZE_LIMIT||r+this.totalSize>this.SIZE_LIMIT)throw new Error("exceed");e.next=15;break;case 15:return o=new K(t,i,r,this.CHUNK_SIZE),this.totalSize+=o.fileSize,e.next=19,new Promise(function(e,t){setTimeout(e,1)});case 19:return e.abrupt("return",o);case 20:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"pause",value:function(e){return!!this.running&&(e.map(function(e){e.processer?e.paused=!0:(e.paused=!0,e.status="paused")}),!0)}},{key:"resume",value:function(e){var t=this;e.map(function(e){e.paused=!1,t.schedule([e.id])})}},{key:"removeFile",value:function(e){return e&&"abort"!==e.status&&(e.paused=!0,e.status="abort",this.totalSize-=e.fileSize,this.IO.deleteFile(e),this.deleteFileFromStore(e)),e}},{key:"distributeToProcessers",value:function(){if(0<this.schedulingFiles.length){this.running=!0;for(var e,t=0,i=this.processers.length;t<i;t++)this.processers[t].idle&&(e=this.schedulingFiles.find(function(e){return e&&"abort"!==e.status&&"complete"!==e.status&&!e.lock&&!e.paused||!1}))&&this.processers[t].run(e,this)}else this.running=!1}}]);var i,t})()});
